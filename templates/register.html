{% extends "base.html" %}
{% block title %}Create Account{% endblock %}
{% block content %}

<section class="auth-section register-bg py-5">
  <div class="auth-container animate-in">

    <!-- Glass Card -->
    <div class="auth-card shadow-lg border-0 p-4 rounded-4">

      <!-- Logo & Heading -->
      <div class="text-center mb-4">
        <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" width="100" class="mb-3">
        <h2 class="fw-bold text-dark">Create Account</h2>
        <p class="text-muted">Join our travel community and start your journey</p>
      </div>

      <!-- Form -->
      <form id="registerForm" method="POST" novalidate>

        <!-- Full Name -->
        <div class="mb-3">
          <label for="name" class="form-label fw-semibold text-dark">Full Name üßë</label>
          <input type="text" id="name" name="name" class="form-control form-control-lg" placeholder="Enter your full name" required>
          <div class="invalid-feedback">Please enter your name.</div>
        </div>

        <!-- Email -->
        <div class="mb-3">
          <label for="email" class="form-label fw-semibold text-dark">Email ‚úâÔ∏è</label>
          <input type="email" id="email" name="email" class="form-control form-control-lg" placeholder="Enter your email" required>
          <div class="invalid-feedback">Please enter a valid email address.</div>
        </div>

        <!-- Password -->
        <div class="mb-3 position-relative">
          <label for="password" class="form-label fw-semibold text-dark">Password üîí</label>
          <input type="password" id="password" name="password" class="form-control form-control-lg" placeholder="Enter your password" required>
          <span id="togglePassword" class="position-absolute top-50 end-0 translate-middle-y me-3" style="cursor:pointer;">
            <i class="bi bi-eye"></i>
          </span>
          <div class="invalid-feedback">Please enter your password.</div>

          <!-- Password Strength -->
          <div class="mt-2">
            <div class="progress" style="height:6px;">
              <div id="strengthBar" class="progress-bar" style="width:0%"></div>
            </div>
            <small id="strengthText" class="text-dark fw-semibold"></small>
          </div>
        </div>

        <!-- Submit -->
        <div class="d-grid mt-4">
          <button type="submit" class="btn btn-gradient-orange fw-bold py-2">Create Account</button>
        </div>
      </form>

      <div class="text-center mt-4">
        <p class="text-muted">Already have an account?
          <a href="{{ url_for('login') }}" class="text-gradient fw-bold">Login here</a>
        </p>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const form = document.getElementById("registerForm");
  const name = document.getElementById("name");
  const email = document.getElementById("email");
  const password = document.getElementById("password");
  const bar = document.getElementById("strengthBar");
  const text = document.getElementById("strengthText");
  const toggle = document.getElementById("togglePassword");

  // ‚úÖ Correct regex (single backslash)
  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

  form.addEventListener("submit", e => {
    let ok = true;
    [name, email, password].forEach(inp => {
      if (!inp.value.trim()) { inp.classList.add("is-invalid"); ok = false; }
      else inp.classList.remove("is-invalid");
    });
    if (!emailRegex.test(email.value.trim())) { 
      email.classList.add("is-invalid"); 
      ok = false; 
    }
    if (!ok) e.preventDefault();
  });

  [name, email, password].forEach(inp =>
    inp.addEventListener("input", () => inp.classList.remove("is-invalid"))
  );

  toggle.addEventListener("click", () => {
    const type = password.type === "password" ? "text" : "password";
    password.type = type;
    toggle.innerHTML = type === "password"
      ? '<i class="bi bi-eye"></i>'
      : '<i class="bi bi-eye-slash"></i>';
  });

  password.addEventListener("input", () => {
    const v = password.value;
    let s = 0;
    if (v.match(/[a-z]/)) s++;
    if (v.match(/[A-Z]/)) s++;
    if (v.match(/[0-9]/)) s++;
    if (v.match(/[$@#&!]/)) s++;
    bar.style.width = (s / 4) * 100 + "%";
    if (s <= 1) { bar.className = "progress-bar bg-danger"; text.textContent = "Weak"; }
    else if (s == 2) { bar.className = "progress-bar bg-warning"; text.textContent = "Medium"; }
    else if (s == 3) { bar.className = "progress-bar bg-info"; text.textContent = "Good"; }
    else { bar.className = "progress-bar bg-success"; text.textContent = "Strong"; }
    text.classList.add("text-dark");  // ‚úÖ black text for strength
  });
});
</script>


{% endblock %}
